import{u as C,r as s,A as v,j as e,C as k,a as S,b as R,c as A,d as L,I as d,g as i,B as T,e as E,f as F,h as D,t as b}from"./index-BQ8-_eRI.js";const M=()=>{const g=C(),[r,f]=s.useState(""),[n,j]=s.useState(""),[u,y]=s.useState(""),[m,l]=s.useState(!1),[x,o]=s.useState(""),h=s.useContext(v);if(!h)throw new Error("AppContext must be used within an AppProvider");const{token:N}=h,w=async t=>{t.preventDefault(),l(!0),o("");try{if(!r||!n)throw new Error("Restaurant title and URL slug are required");const a=n.toLowerCase().replace(/[^a-z0-9-]/g,"-");if((await(await fetch(`${i.backend_url}/api/check-slug/${a}`)).json()).exists){o("Slug is already taken. Please choose a different one."),l(!1);return}const p=await fetch(`${i.backend_url}/api/create-restaurant`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${N}`,Accept:"application/json"},body:JSON.stringify({title:r,slug:a,whatsapp:u})});if(!p.ok){const c=await p.json();throw b.message(`${c.errors}`),console.log(c.errors),new Error(c.error||"Failed to create restaurant")}b.success("Restaurant Created Successfully"),g("/dashboard")}catch(a){o(a instanceof Error?a.message:"Failed to create restaurant"),console.error("Restaurant creation error:",a)}finally{l(!1)}};return e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gradient-to-br from-amber-50 to-amber-100 p-4",children:e.jsxs(k,{className:"w-full max-w-md shadow-xl rounded-xl overflow-hidden border border-amber-100",children:[e.jsxs(S,{className:"space-y-4 text-center",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full bg-amber-50 border border-amber-100",children:e.jsx("span",{className:"text-sm font-bold bg-gradient-to-r from-amber-600 to-amber-600 bg-clip-text text-transparent",children:"MenuLink"})})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{className:"text-2xl font-bold text-amber-800",children:"Complete Your Setup"}),e.jsx(A,{className:"text-gray-600",children:"A few more details to get started"})]})]}),e.jsx(L,{children:e.jsxs("form",{onSubmit:w,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"restaurantTitle",className:"block text-sm font-medium text-gray-700",children:"Restaurant Title"}),e.jsx(d,{id:"restaurantTitle",placeholder:"My Awesome Restaurant",value:r,onChange:t=>f(t.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"slug",className:"block text-sm font-medium text-gray-700",children:"Your Restaurant Slug (Link)"}),e.jsxs("div",{className:"flex rounded-md shadow-sm",children:[e.jsxs("span",{className:"inline-flex items-center px-3 rounded-l-md border border-r-0 border-gray-300 bg-gray-50 text-gray-500 text-sm",children:[i.public_url,"/"]}),e.jsx(d,{id:"slug",type:"text",placeholder:"your-restaurant",value:n,onChange:t=>{const a=t.target.value.toLowerCase().replace(/[^a-z0-9-]/g,"-");j(a)},required:!0,pattern:"[a-z0-9-]+",title:"Only lowercase letters, numbers, and hyphens are allowed",className:"flex-1 block w-full rounded-none rounded-r-md"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Only lowercase letters, numbers, and hyphens are allowed"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"whatsappNumber",className:"block text-sm font-medium text-gray-700",children:"WhatsApp Number"}),e.jsx(d,{id:"whatsappNumber",placeholder:"+91 9876543210",type:"tel",value:u,onChange:t=>y(t.target.value)}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"You will receive orders on this number"})]}),e.jsx(T,{disabled:m,type:"submit",className:"w-full bg-amber-600 hover:bg-amber-700 transition-colors duration-200 shadow-md mt-4",children:m?e.jsxs(e.Fragment,{children:[e.jsx(E,{className:"mr-2 h-4 w-4 animate-spin"}),"Setting up..."]}):"Complete Setup"}),x&&e.jsx("div",{className:"p-3 bg-red-50 border border-red-200 text-red-600 rounded-md text-sm",children:x})]})}),e.jsx(F,{className:"flex justify-center",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Need help? ",e.jsx("span",{onClick:D,className:"font-medium text-amber-600 hover:text-amber-700 hover:underline",children:"Contact support"})]})})]})})};export{M as default};

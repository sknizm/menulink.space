import{i as G,r,v as F,D as L,j as e,E as z,U as _,x as U,V as $,W as q,m as E,A as J,Y as V,B as X,e as R,Z as g,I as j,g as P,t as N}from"./index-D4T5xC-q.js";/**
 * @license lucide-react v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],A=G("save",W);var k="Switch",[Y,ae]=z(k),[Z,K]=Y(k),B=r.forwardRef((a,i)=>{const{__scopeSwitch:n,name:h,checked:c,defaultChecked:w,required:d,disabled:u,value:f="on",onCheckedChange:y,form:m,...p}=a,[l,x]=r.useState(null),v=F(i,b=>x(b)),s=r.useRef(!1),o=l?m||!!l.closest("form"):!0,[t,C]=L({prop:c,defaultProp:w??!1,onChange:y,caller:k});return e.jsxs(Z,{scope:n,checked:t,disabled:u,children:[e.jsx(_.button,{type:"button",role:"switch","aria-checked":t,"aria-required":d,"data-state":D(t),"data-disabled":u?"":void 0,disabled:u,value:f,...p,ref:v,onClick:U(a.onClick,b=>{C(H=>!H),o&&(s.current=b.isPropagationStopped(),s.current||b.stopPropagation())})}),o&&e.jsx(M,{control:l,bubbles:!s.current,name:h,value:f,checked:t,required:d,disabled:u,form:m,style:{transform:"translateX(-100%)"}})]})});B.displayName=k;var I="SwitchThumb",O=r.forwardRef((a,i)=>{const{__scopeSwitch:n,...h}=a,c=K(I,n);return e.jsx(_.span,{"data-state":D(c.checked),"data-disabled":c.disabled?"":void 0,...h,ref:i})});O.displayName=I;var Q="SwitchBubbleInput",M=r.forwardRef(({__scopeSwitch:a,control:i,checked:n,bubbles:h=!0,...c},w)=>{const d=r.useRef(null),u=F(d,w),f=$(n),y=q(i);return r.useEffect(()=>{const m=d.current;if(!m)return;const p=window.HTMLInputElement.prototype,x=Object.getOwnPropertyDescriptor(p,"checked").set;if(f!==n&&x){const v=new Event("click",{bubbles:h});x.call(m,n),m.dispatchEvent(v)}},[f,n,h]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n,...c,tabIndex:-1,ref:u,style:{...c.style,...y,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});M.displayName=Q;function D(a){return a?"checked":"unchecked"}var T=B,ee=O;const S=r.forwardRef(({className:a,...i},n)=>e.jsx(T,{className:E("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",a),...i,ref:n,children:e.jsx(ee,{className:E("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));S.displayName=T.displayName;function te(){const[a,i]=r.useState({name:"",address:"",whatsapp:"",phone:"",instagram:"",settings:{}}),[n,h]=r.useState(a),[c,w]=r.useState(!1),[d,u]=r.useState(!1),[f,y]=r.useState(!0),m=r.useContext(J);if(!m)throw new Error("AppContext must be used within an AppProvider");const{token:p}=m;r.useEffect(()=>{if(!p)return;(async()=>{try{const o=await fetch(`${P.backend_url}/api/restaurant-by-user`,{headers:{Authorization:`Bearer ${p}`,Accept:"application/json"}});if(!o.ok)throw new Error("Failed to fetch restaurant");const t=await o.json();if(t.success&&t.data){const C=t.data.settings||{},b={...t.data,settings:C};i(b),h(b)}else throw new Error(t.message||"Restaurant not found")}catch(o){N.error("Failed to load restaurant"),console.error(o)}finally{y(!1)}})()},[p]),r.useEffect(()=>{const s=JSON.stringify(a)!==JSON.stringify(n);w(s)},[a,n]);const l=(s,o)=>{i(t=>({...t,[s]:o}))},x=(s,o)=>{i(t=>({...t,settings:{...t.settings,[s]:o}}))},v=async()=>{if(!p){N.error("You must be logged in to update.");return}try{u(!0);const s=await fetch(`${P.backend_url}/api/update-restaurant`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${p}`,Accept:"application/json"},body:JSON.stringify({name:a.name,address:a.address,whatsapp:a.whatsapp,phone:a.phone,instagram:a.instagram,settings:{isGrid:a.settings.isGrid??null,isOrder:a.settings.isOrder??null,facebook:a.settings.facebook??null}})});if(!s.ok){const t=await s.json();throw new Error(t.message||"Failed to update")}const o=await s.json();h({...a,settings:o.data.settings||{}}),N.success("Changes saved successfully")}catch(s){N.error("Failed to save changes"),console.error(s)}finally{u(!1)}};return f?e.jsx(V,{}):e.jsxs("div",{className:"space-y-6 p-4 md:p-6 max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Restaurant Settings"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage your restaurant details and preferences"})]}),e.jsxs(X,{onClick:v,disabled:d||!c,className:"w-full md:w-auto",children:[d?e.jsx(R,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(A,{className:"mr-2 h-4 w-4"}),"Save Changes",c&&!d&&e.jsx("span",{className:"ml-2 text-xs bg-amber-100 text-amber-800 px-2 py-0.5 rounded-full",children:"Unsaved"})]})]}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"bg-white rounded-lg border p-6 shadow-sm",children:[e.jsx("h2",{className:"text-xl font-semibold mb-6 pb-2 border-b",children:"Restaurant Information"}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"name",children:"Business Name"}),e.jsx(j,{id:"name",value:a.name,onChange:s=>l("name",s.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"address",children:"Address"}),e.jsx(j,{id:"address",value:a.address,onChange:s=>l("address",s.target.value),placeholder:"Enter your restaurant address"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(g,{htmlFor:"isOrder",children:"Enable Online Orders"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Allow customers to place orders online"})]}),e.jsx(S,{id:"isOrder",checked:!!a.settings.isOrder,onCheckedChange:s=>x("isOrder",s)})]}),e.jsxs("div",{className:"space-y-2 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(g,{htmlFor:"isGrid",children:"Display Menu as Grid"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Show menu items in a grid layout instead of list"})]}),e.jsx(S,{id:"isGrid",checked:!!a.settings.isGrid,onCheckedChange:s=>x("isGrid",s)})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border p-6 shadow-sm",children:[e.jsx("h2",{className:"text-xl font-semibold mb-6 pb-2 border-b",children:"Contact Information"}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"whatsapp",children:"WhatsApp Number"}),e.jsx(j,{id:"whatsapp",value:a.whatsapp,onChange:s=>l("whatsapp",s.target.value),required:!0,placeholder:"+91XXXXXXXXXX"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Customers will contact you on this number"})]})}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"phone",children:"Phone Number"}),e.jsx(j,{id:"phone",value:a.phone,onChange:s=>l("phone",s.target.value),placeholder:"+91XXXXXXXXXX"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Additional contact number (optional)"})]})})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border p-6 shadow-sm",children:[e.jsx("h2",{className:"text-xl font-semibold mb-6 pb-2 border-b",children:"Social Media"}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"instagram",children:"Instagram Handle"}),e.jsx(j,{id:"instagram",value:a.instagram,onChange:s=>l("instagram",s.target.value),placeholder:"@yourhandle"})]})}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"facebook",children:"Facebook Page"}),e.jsx(j,{id:"facebook",placeholder:"https://facebook.com/yourpage",value:a.settings.facebook||"",onChange:s=>x("facebook",s.target.value)})]})})]})]})]}),c&&e.jsxs("div",{className:"fixed bottom-4 right-4 bg-white p-4 rounded-lg shadow-lg border border-amber-200 flex items-center gap-4",children:[e.jsx("div",{className:"text-amber-800",children:"You have unsaved changes"}),e.jsxs(X,{onClick:v,disabled:d,size:"sm",className:"bg-amber-600 hover:bg-amber-700",children:[d?e.jsx(R,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(A,{className:"mr-2 h-4 w-4"}),"Save"]})]})]})}export{te as default};
